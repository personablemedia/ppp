(function(e){var t,n,r,i=Array.prototype.slice;if(e.browser==null){r=navigator.userAgent||"";jQuery.uaMatch=function(e){var t;e=e.toLowerCase();t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}};n=jQuery.uaMatch(r);jQuery.browser={};if(n.browser){jQuery.browser[n.browser]=true;jQuery.browser.version=n.version}if(jQuery.browser.webkit)jQuery.browser.safari=true}t=function(){function t(n,r){var i,s,o;this.elem=e(n);s=e.extend({},t.defaults,r);for(i in s){o=s[i];this[i]=o}this.elem.data(this.dataName,this);this.wrapCheckboxWithDivs();this.attachEvents();this.disableTextSelection();if(this.resizeHandle)this.optionallyResize("handle");if(this.resizeContainer)this.optionallyResize("container");this.initialPosition()}t.prototype.isDisabled=function(){return this.elem.is(":disabled")};t.prototype.wrapCheckboxWithDivs=function(){this.elem.wrap("<div class='"+this.containerClass+"' />");this.container=this.elem.parent();this.offLabel=e("<label class='"+this.labelOffClass+"'>\n  <span>"+this.uncheckedLabel+"</span>\n</label>").appendTo(this.container);this.offSpan=this.offLabel.children("span");this.onLabel=e("<label class='"+this.labelOnClass+"'>\n  <span>"+this.checkedLabel+"</span>\n</label>").appendTo(this.container);this.onSpan=this.onLabel.children("span");return this.handle=e("<div class='"+this.handleClass+"'>\n  <div class='"+this.handleRightClass+"'>\n    <div class='"+this.handleCenterClass+"' />\n  </div>\n</div>").appendTo(this.container)};t.prototype.disableTextSelection=function(){if(e.browser.msie){return e([this.handle,this.offLabel,this.onLabel,this.container]).attr("unselectable","on")}};t.prototype._getDimension=function(t,n){if(e.fn.actual!=null){return t.actual(n)}else{return t[n]()}};t.prototype.optionallyResize=function(e){var t,n,r;r=this._getDimension(this.onLabel,"width");n=this._getDimension(this.offLabel,"width");if(e==="container"){t=r>n?r:n;t+=this._getDimension(this.handle,"width")+this.handleMargin;return this.container.css({width:t})}else{t=r>n?r:n;return this.handle.css({width:t})}};t.prototype.onMouseDown=function(e){var n;e.preventDefault();if(this.isDisabled())return;n=e.pageX||e.originalEvent.changedTouches[0].pageX;t.currentlyClicking=this.handle;t.dragStartPosition=n;return t.handleLeftOffset=parseInt(this.handle.css("left"),10)||0};t.prototype.onDragMove=function(e,n){var r,i;if(t.currentlyClicking!==this.handle)return;i=(n+t.handleLeftOffset-t.dragStartPosition)/this.rightSide;if(i<0)i=0;if(i>1)i=1;r=i*this.rightSide;this.handle.css({left:r});this.onLabel.css({width:r+this.handleRadius});this.offSpan.css({marginRight:-r});return this.onSpan.css({marginLeft:-(1-i)*this.rightSide})};t.prototype.onDragEnd=function(e,n){var r;if(t.currentlyClicking!==this.handle)return;if(this.isDisabled())return;if(t.dragging){r=(n-t.dragStartPosition)/this.rightSide;this.elem.prop("checked",r>=.5)}else{this.elem.prop("checked",!this.elem.prop("checked"))}t.currentlyClicking=null;t.dragging=null;return this.didChange()};t.prototype.refresh=function(){return this.didChange()};t.prototype.didChange=function(){var e;if(typeof this.onChange==="function"){this.onChange(this.elem,this.elem.prop("checked"))}if(this.isDisabled()){this.container.addClass(this.disabledClass);return false}else{this.container.removeClass(this.disabledClass)}e=this.elem.prop("checked")?this.rightSide:0;this.handle.animate({left:e},this.duration);this.onLabel.animate({width:e+this.handleRadius},this.duration);this.offSpan.animate({marginRight:-e},this.duration);return this.onSpan.animate({marginLeft:e-this.rightSide},this.duration)};t.prototype.attachEvents=function(){var t,n,r;r=this;t=function(e){return r.onGlobalMove.apply(r,arguments)};n=function(i){r.onGlobalUp.apply(r,arguments);e(document).unbind("mousemove touchmove",t);return e(document).unbind("mouseup touchend",n)};this.elem.change(function(){return r.refresh()});return this.container.bind("mousedown touchstart",function(i){r.onMouseDown.apply(r,arguments);e(document).bind("mousemove touchmove",t);return e(document).bind("mouseup touchend",n)})};t.prototype.initialPosition=function(){var t,n;t=this._getDimension(this.container,"width");this.offLabel.css({width:t-this.containerRadius});n=this.containerRadius+1;if(e.browser.msie&&e.browser.version<7)n-=3;this.rightSide=t-this._getDimension(this.handle,"width")-n;if(this.elem.is(":checked")){this.handle.css({left:this.rightSide});this.onLabel.css({width:this.rightSide+this.handleRadius});this.offSpan.css({marginRight:-this.rightSide})}else{this.onLabel.css({width:0});this.onSpan.css({marginLeft:-this.rightSide})}if(this.isDisabled())return this.container.addClass(this.disabledClass)};t.prototype.onGlobalMove=function(e){var n;if(!(!this.isDisabled()&&t.currentlyClicking))return;e.preventDefault();n=e.pageX||e.originalEvent.changedTouches[0].pageX;if(!t.dragging&&Math.abs(t.dragStartPosition-n)>this.dragThreshold){t.dragging=true}return this.onDragMove(e,n)};t.prototype.onGlobalUp=function(e){var n;if(!t.currentlyClicking)return;e.preventDefault();n=e.pageX||e.originalEvent.changedTouches[0].pageX;this.onDragEnd(e,n);return false};t.defaults={duration:200,checkedLabel:"ON",uncheckedLabel:"OFF",resizeHandle:true,resizeContainer:true,disabledClass:"iPhoneCheckDisabled",containerClass:"iPhoneCheckContainer",labelOnClass:"iPhoneCheckLabelOn",labelOffClass:"iPhoneCheckLabelOff",handleClass:"iPhoneCheckHandle",handleCenterClass:"iPhoneCheckHandleCenter",handleRightClass:"iPhoneCheckHandleRight",dragThreshold:5,handleMargin:15,handleRadius:4,containerRadius:5,dataName:"iphoneStyle",onChange:function(){}};return t}();e.iphoneStyle=this.iOSCheckbox=t;e.fn.iphoneStyle=function(){var n,r,s,o,u,a,f,l,c,h,p,d;n=1<=arguments.length?i.call(arguments,0):[];s=(c=(h=n[0])!=null?h.dataName:void 0)!=null?c:t.defaults.dataName;p=this.filter(":checkbox");for(f=0,l=p.length;f<l;f++){r=p[f];o=e(r).data(s);if(o!=null){u=n[0],a=2<=n.length?i.call(n,1):[];if((d=o[u])!=null){d.apply(o,a)}}else{new t(r,n[0])}}return this};e.fn.iOSCheckbox=function(t){var n;if(t==null)t={};n=e.extend({},t,{resizeHandle:false,disabledClass:"iOSCheckDisabled",containerClass:"iOSCheckContainer",labelOnClass:"iOSCheckLabelOn",labelOffClass:"iOSCheckLabelOff",handleClass:"iOSCheckHandle",handleCenterClass:"iOSCheckHandleCenter",handleRightClass:"iOSCheckHandleRight",dataName:"iOSCheckbox"});return this.iphoneStyle(n)}})(jQuery);